<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fun with Filters and Frequencies</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        header {
            background-color: #000000;
            color: white;
            text-align: center;
            padding: 1rem;
        }
        section {
            padding: 2rem;
            margin: 1rem;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        h2 {
            color: #000000;
        }
        .container {
            display: block; 
        }
        .section-wrapper {
            width: 100%; 
            padding: 10px;
        }
        .image-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .image-container img {
            width: 45%; /* Adjusts the width of the images */
            height: auto;
        }
        .text-box {
            width: 100px; /* Width of the text box */
            margin-left: 10px; /* Spacing between the image and the text box */
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .gallery-container {
            margin: 20px;
        }
        .gallery {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
        }
        .gallery-item {
            max-width: 300px;
            text-align: center;
        }
        .gallery-item img {
            width: 100%;
            height: auto;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        figcaption {
            margin-top: 8px;
            font-size: 14px;
            color: #555;
        }
        
    </style>
</head>
<body>

<header>
    <h1>Programming Project #2: Fun with Filters and Frequencies!</h1>
    <h1>By Sai Kolasani</h1>
</header>

<main class="container">
    <div class="section-wrapper">
        <section id="introduction">
            <h2>Introduction</h2>
            <p>In this project we explore diffeent ways of using frequencies to process and combine images in interesting ways. 
                For example, similar to what our phones do, we can sharpen images by emphasizing high frequencies. We can also extract edges using finite difference operators.
                Hybrid images which look one way close up and another far away can also be created by combined high frequencies of one image with the low frequencies of an other.
                Lastly, images can be blended togerther at verious frequencies with the help of gaussian and laplacian stacks.
            </p>
        </section>
    </div>

    <div class="section-wrapper">
        <section id="singlescale">
            <h2>Fun with Filters</h2>
            <h3>Finite Difference Operator</h3>
            <p>Finite Difference Operators help detect edges by highlighting regions where pixel intensity changes rapidly, which usually corresponds to edges or boundaries in the image.
                In two-dimensional images, the finite difference operator computes the derivative in both the horizontal (x) and vertical (y) directions. These derivatives are calculated using simple convolution filters, such as:
            </p>
            <ul>
                <li><strong>Dx = [1, -1]</strong>: for detecting horizontal changes (vertical edges).</li>
                <li><strong>Dy = [[1], [-1]]</strong>: for detecting vertical changes (horizontal edges).</li>
            </ul>
            <p>
                When these operators are applied to an image, they produce two gradient images:
            </p>
            <ul>
                <li>The gradient in the <strong>x-direction</strong> highlights vertical edges.</li>
                <li>The gradient in the <strong>y-direction</strong> highlights horizontal edges.</li>
            </ul>
            <p>
                By combining these gradients we can produce an edge-detection image that reveals significant changes in intensity.
            </p>
            <h3>Results</h3>
            <div class="gallery-container">
                <div class="gallery">
                    <figure class="gallery-item"></figure>
                        <img src="assets/cameraman.png" alt="Cameraman Image">
                        <figcaption>Original Image</figcaption>
                    </figure>
                    <figure class="gallery-item">
                        <img src="assets/PartialX.jpg" alt="XGradient">
                        <figcaption>Dx</figcaption>
                    </figure>
                    <figure class="gallery-item">
                        <img src="assets/PartialY.jpg" alt="YGradient">
                        <figcaption>Dy</figcaption>
                    </figure>
                    <figure class="gallery-item">
                        <img src="assets/GradCombined.jpg" alt="Combined Gradients">
                        <figcaption>Combined Gradients</figcaption>
                    </figure>
                    <figure class="gallery-item"></figure>
                        <img src="assets/BinaryEdge.jpg" alt="Binarized Image">
                        <figcaption>Binarized Image</figcaption>
                    </figure>
                </div>
            </div>
        </section>
    </div>

    <div class="section-wrapper">
        <section id="multiscale">
            <h2>Multi Scale Alignment</h2>
            <p>However, the exhaustive search would become too computationally expensive for images with higher resolutions and larger displacements.
                To combat this issue, I implemented an Image pyramid that searches for shifts in multiple scales. 
            </p>
             <h3>Algorithm Steps</h3>
            <ol>
                <li>Downscale both the reference image and the image to align using multiple scaling factors. Starting with the coarsest (smallest) image and working to the finest (full resolution).</li>
                <li>Similarly to the single scale implementation, crop 10% of the image borders at each scale to focus on the central region.</li>
                <li>At each scale, search for the best displacement (shift) by trying different pixel shifts in height and width directions.</li>
                <li>For each shift, calculate a similarity score using normalized cross-correlation.</li>
                <li>Once the best displacement is found at a coarse scale, adjust the search range for the next finer scale using the best shift found so far.</li>
                <li>After refining the alignment at all scales, apply the final best displacement to the original image to align it with the reference image.</li>
            </ol>
            <p>As before, I also parallelized the code using a ThreadPoolExecutor to improve the speed to roughly 30s per picture, whereas before, it would take up to 2 minutes.</p>
            <h3>High Resolution Image Gallery</h3>
            <div class="gallery-container">
                <div class="gallery">
                    <figure class="gallery-item">
                        <img src="assets/emir.jpg" alt="emir">
                        <figcaption>R Shift: (-240, 96), G Shift: (24, 48)</figcaption>
                    </figure>
                    <figure class="gallery-item">
                        <img src="assets/church.jpg" alt="church">
                        <figcaption>R Shift: (-8, 56), G Shift: (0, 24)</figcaption>
                    </figure>
                    <figure class="gallery-item">
                        <img src="assets/harvesters.jpg" alt="harvesters">
                        <figcaption>R Shift: (16, 120), G Shift: (16, 56)</figcaption>
                    </figure>
                    <figure class="gallery-item">
                        <img src="assets/icon.jpg" alt="icon">
                        <figcaption>R Shift: (24, 88), G Shift: (16, 40)</figcaption>
                    </figure>
                    <figure class="gallery-item">
                        <img src="assets/lady.jpg" alt="lady">
                        <figcaption>R Shift: (8, 112), G Shift: (8, 48)</figcaption>
                    </figure>
                    <figure class="gallery-item">
                        <img src="assets/melons.jpg" alt="melons">
                        <figcaption>R Shift: (8, 176), G Shift: (8, 80)</figcaption>
                    </figure>
                    <figure class="gallery-item">
                        <img src="assets/onion_church.jpg" alt="onion_church">
                        <figcaption>R Shift: (40, 104), G Shift: (24, 48)</figcaption>
                    </figure>
                    <figure class="gallery-item">
                        <img src="assets/sculpture.jpg" alt="sculpture">
                        <figcaption>R Shift: (-24, 136), G Shift: (-8, 32)</figcaption>
                    </figure>
                    <figure class="gallery-item">
                        <img src="assets/self_portrait.jpg" alt="self_portrait">
                        <figcaption>R Shift: (40, 176), G Shift: (32, 80)</figcaption>
                    </figure>
                    <figure class="gallery-item">
                        <img src="assets/three_generations.jpg" alt="three_generations">
                        <figcaption>R Shift: (8, 112), G Shift: (16, 56)</figcaption>
                    </figure>
                    <figure class="gallery-item">
                        <img src="assets/train.jpg" alt="train">
                        <figcaption>R Shift: (32, 88), G Shift: (8, 40)</figcaption>
                    </figure>
                </div>
            </div>
            <h3>Notes:</h3>
            <p>One thing to notice is that the Emir picture does not seem to have aligned properly, while the rest of the images look good. This is most likely because the blue plate was used as the reference for matching, 
                In this case, there was a very high amount of blue but a meager amount of green. So, aligning the red and blue to the 
                green fixes the issue in this case.</p>
        </section>
    </div>

    <div class="section-wrapper">
        <section id="bells & whistles">
            <h2>Bells & Whistles</h2>
            <p> To fix the issue with the Emir picture, I used the Structural Similarity Index Measure (SSIM)
                as the scoring metric. This fixed the issue with the Emir picture, which can be seen below. Furthermore,
                the shifts seemed fairly the same for the rest of the images. Due to this, using NCC is generally
                much faster than SSIM, but SSIM produces better results.
            </p>

            <h3>NCC vs SSIM</h3>
            <div class="gallery-container">
                <div class="gallery">
                    <figure class="gallery-item">
                        <img src="assets/emir.jpg" alt="emir ncc image">
                        <figcaption> NCC Picture:
                            R Shift: (-240, 96), G Shift: (24, 48)</figcaption>
                    </figure>
                    <figure class="gallery-item">
                        <img src="assets/ssim_emir.jpg" alt="emir ssim image">
                        <figcaption> SSIM Picture: 
                            R Shift: (40, 104), G Shift: (24, 48)</figcaption>
                    </figure>
                    
                </div>
                <div class="gallery">
                    <figure class="gallery-item">
                        <img src="assets/three_generations.jpg" alt="three_generations ncc image">
                        <figcaption> NCC Picture:
                            R Shift: (8, 112), G Shift: (16, 56)</figcaption>
                    </figure>
                    <figure class="gallery-item">
                        <img src="assets/ssim_three_generations.jpg" alt="three_generations ssim image">
                        <figcaption> SSIM Picture: 
                            R Shift: (8, 112), G Shift: (16, 48)</figcaption>
                    </figure>
                    
                </div>
            </div>
        </section>
    </div>

</main>


</body>
</html>
